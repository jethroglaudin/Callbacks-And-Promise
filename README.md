Working with callbacks, promises, and setTimeout